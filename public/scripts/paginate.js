(function(){var l;try{l=angular.module("angularUtils.directives.dirPagination")}catch(v){l=angular.module("angularUtils.directives.dirPagination",[])}l.directive("dirPaginate",["$compile","$parse","paginationService",function(b,f,c){return{terminal:!0,multiElement:!0,priority:5E3,compile:function(e,a){var n=a.dirPaginate,m=n.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),t=/\|\s*itemsPerPage\s*:[^|]*/;if(null===m[2].match(t))throw"pagination directive: the 'itemsPerPage' filter must be set."; var m=m[2].replace(t,""),p=f(m);c.registerInstance(a.paginationId||"__default");return function(a,d,h){var g=f(h.paginationId)(a)||h.paginationId||"__default";c.registerInstance(g);var k;k=!!n.match(/(\|\s*itemsPerPage\s*:[^|]*:[^|]*)/);k="__default"===g||k?n:n.replace(/(\|\s*itemsPerPage\s*:[^|]*)/,"$1 : '"+g+"'");d[0].hasAttribute("dir-paginate-start")||d[0].hasAttribute("data-dir-paginate-start")?(h.$set("ngRepeatStart",k),d.eq(d.length-1).attr("ng-repeat-end",!0)):h.$set("ngRepeat",k);d=b(d,!1, 5E3);h.currentPage?k=f(h.currentPage):(k=g+"__currentPage",a[k]=1,k=f(k));c.setCurrentPageParser(g,k,a);"undefined"!==typeof h.totalItems?(c.setAsyncModeTrue(g),a.$watch(function(){return f(h.totalItems)(a)},function(a){0<=a&&c.setCollectionLength(g,a)})):a.$watchCollection(function(){return p(a)},function(a){a&&c.setCollectionLength(g,a.length)});d(a)}}}}]);l.directive("dirPaginationControls",["paginationService","paginationTemplate",function(b,f){function c(a,c,b,e){var f=[];c=Math.ceil(c/b);b= Math.ceil(e/2);b=a<=b?"start":c-b<a?"end":"middle";for(var l=e<c,d=1;d<=c&&d<=e;){var h;h=d;var g=a,k=e,q=c,r=Math.ceil(k/2);h=h===k?q:1===h?h:k<q?q-r<g?q-k+h:r<g?g-r+h:h:h;g=2===d&&("middle"===b||"end"===b);k=d===e-1&&("middle"===b||"start"===b);l&&(g||k)?f.push("..."):f.push(h);d++}return f}var e=/^\d+$/;return{restrict:"AE",templateUrl:function(a,b){return b.templateUrl||f.getPath()},scope:{maxSize:"=?",onPageChange:"&?",paginationId:"=?"},link:function(a,f,m){function l(g){if(u(g)&&(a.pages=c(g, b.getCollectionLength(d),b.getItemsPerPage(d),h),a.pagination.current=g,p(),a.onPageChange))a.onPageChange({newPageNumber:g})}function p(){var c=b.getCurrentPage(d),e=b.getItemsPerPage(d),f=b.getCollectionLength(d);a.range.lower=(c-1)*e+1;a.range.upper=Math.min(c*e,f);a.range.total=f}function u(b){return e.test(b)&&0<b&&b<=a.pagination.last}f=m.paginationId||"__default";var d=a.paginationId||m.paginationId||"__default";if(!b.isRegistered(d)&&!b.isRegistered(f))throw"pagination directive: the pagination controls"+ ("__default"!==d?" (id: "+d+") ":" ")+"cannot be used without the corresponding pagination directive.";a.maxSize||(a.maxSize=9);a.directionLinks=angular.isDefined(m.directionLinks)?a.$parent.$eval(m.directionLinks):!0;a.boundaryLinks=angular.isDefined(m.boundaryLinks)?a.$parent.$eval(m.boundaryLinks):!1;var h=Math.max(a.maxSize,5);a.pages=[];a.pagination={last:1,current:1};a.range={lower:1,upper:1,total:1};a.$watch(function(){return(b.getCollectionLength(d)+1)*b.getItemsPerPage(d)},function(g){0< g&&(g=parseInt(b.getCurrentPage(d))||1,a.pages=c(g,b.getCollectionLength(d),b.getItemsPerPage(d),h),a.pagination.current=g,a.pagination.last=a.pages[a.pages.length-1],a.pagination.last<a.pagination.current?a.setCurrent(a.pagination.last):p())});a.$watch(function(){return b.getItemsPerPage(d)},function(b,c){b!=c&&"undefined"!==typeof c&&l(a.pagination.current)});a.$watch(function(){return b.getCurrentPage(d)},function(a,b){a!=b&&l(a)});a.setCurrent=function(a){u(a)&&b.setCurrentPage(d,a)}}}}]);l.filter("itemsPerPage", ["paginationService",function(b){return function(f,c,e){"undefined"===typeof e&&(e="__default");if(!b.isRegistered(e))throw"pagination directive: the itemsPerPage id argument (id: "+e+") does not match a registered pagination-id.";var a,l;return f instanceof Array?(c=parseInt(c)||9999999999,l=b.isAsyncMode(e)?0:(b.getCurrentPage(e)-1)*c,a=l+c,b.setItemsPerPage(e,c),f.slice(l,a)):f}}]);l.service("paginationService",function(){var b={},f;this.registerInstance=function(c){"undefined"===typeof b[c]&& (b[c]={asyncMode:!1},f=c)};this.isRegistered=function(c){return"undefined"!==typeof b[c]};this.getLastInstanceId=function(){return f};this.setCurrentPageParser=function(c,e,a){b[c].currentPageParser=e;b[c].context=a};this.setCurrentPage=function(c,e){b[c].currentPageParser.assign(b[c].context,e)};this.getCurrentPage=function(c){var e=b[c].currentPageParser;return e?e(b[c].context):1};this.setItemsPerPage=function(c,e){b[c].itemsPerPage=e};this.getItemsPerPage=function(c){return b[c].itemsPerPage}; this.setCollectionLength=function(c,e){b[c].collectionLength=e};this.getCollectionLength=function(c){return b[c].collectionLength};this.setAsyncModeTrue=function(c){b[c].asyncMode=!0};this.isAsyncMode=function(c){return b[c].asyncMode}});l.provider("paginationTemplate",function(){var b="directives/pagination/dirPagination.tpl.html";this.setPath=function(f){b=f};this.$get=function(){return{getPath:function(){return b}}}})})();
